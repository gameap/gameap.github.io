<!DOCTYPE html>
<html lang="{{ page.lang }}">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <title>{{ site.title }}{% if page.title %} : {{ page.title }}{% endif %}</title>

        <link rel="stylesheet" href="{{ site.baseurl }}/css/syntax.css">
        <link rel="stylesheet" href="{{ site.baseurl }}/css/main.css">
        <link rel="stylesheet" href="{{ site.baseurl }}/css/github-markdown.css">
    </head>
    <body>

        {% include header.html %}

        <div class="container">
            <div class="row">
                {% assign post_count = site.posts|size %}
                {% if site.navigation != 0 and site.navigation == 1 and page.disable_navigation != 1 %}
                    <aside id="navigation" class="col-md-3">
                        {% include navigation.html %}
                    </aside>

                    <section id="content" class="col-sm-12 col-md-9 col-lg-6 markdown-body entry-content">
                        <h1>{{ page.title }}</h1>
                        {{ content }}
                    </section>

                    <aside class="col-lg-3 noprint d-none d-lg-block">
                        <nav id="toc" class="sticky-top"></nav>
                    </aside>
                {% else %}
                    <div id="content" class="col-md-12">
                        {{ content }}
                    </div>
                {% endif %}
            </div>

            {% if page.disqus == 1 %}
                <div class="row">
                  {% if site.navigation == 1 or post_count > 0 %}
                    <div id="navigation" class="col-sm-2"></div>
                    <div id="disqus" class="col-sm-10">
                        {% include disqus.html %}
                    </div>
                  {% else %}
                    <div id="disqus" class="col-sm-12">
                        {% include disqus.html %}
                    </div>
                  {% endif %}
                </div>
            {% endif %}

            <div class="row">
                <div id="footer" class="col-sm-12">
                    {% include footer.html %}
                </div>
            </div>
        </div>

        <script>
            // Navigation collapse toggle
            document.querySelectorAll('.nav-section-toggle').forEach(function(btn) {
                btn.addEventListener('click', function() {
                    btn.parentElement.classList.toggle('is-open');
                });
            });

            // Code copy button
            document.querySelectorAll('.highlight, pre').forEach(function(block) {
                if (block.closest('.highlight') && block.tagName === 'PRE') return;

                var btn = document.createElement('button');
                btn.className = 'code-copy-btn';
                btn.textContent = 'Copy';

                btn.addEventListener('click', function() {
                    var code = block.querySelector('code') || block;
                    var text = code.textContent;

                    navigator.clipboard.writeText(text).then(function() {
                        btn.textContent = 'Copied!';
                        btn.classList.add('copied');
                        setTimeout(function() {
                            btn.textContent = 'Copy';
                            btn.classList.remove('copied');
                        }, 2000);
                    });
                });

                block.style.position = 'relative';
                block.appendChild(btn);
            });
        </script>
        {% include yandex_metrika.html %}

        <script src="{{ site.baseurl }}/assets/js/toc.js"></script>
        <script src="{{ site.baseurl }}/assets/js/tabs.js"></script>
    </body>
</html>
